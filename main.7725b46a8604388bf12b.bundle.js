(()=>{"use strict";var e,t={11:(e,t,i)=>{var s=i(260);const r={score:0,highscore:0,gridWidth:8,gridHeight:8,tileWidth:64,tileHeight:72,margin:10,candyTypes:["cookie1","cookie2","croissant","cupcake","donut","eclair","macaroon","pie","poptart1","poptart2","starcookie1","starcookie2"]};var h;!function(e){e.LOADING="LoadingScene",e.GAMEPLAY="GamePlayScene"}(h||(h={}));class l extends Phaser.GameObjects.Image{constructor(e,t,i){super(e.scene,e.x,e.y,e.texture,e.frame),this.setOrigin(.5,.5).setInteractive().setDepth(5),this.gridX=t,this.gridY=i,this.graphics=this.scene.add.graphics().lineStyle(2,12183295).setVisible(!1).setDepth(4),this.graphics.strokeRoundedRect(0,0,this.width+2,this.height),this.setGraphics(),this.scene.add.existing(this),this.tween=this.scene.tweens.add({targets:this,angle:360,duration:1500,ease:"Linear",repeat:-1}),this.tween.pause()}spin(){this.tween.resume()}unSpin(){this.tween.pause(),this.scene.tweens.add({targets:this,angle:0,duration:500,ease:"Power2"})}showGraphics(){this.setGraphics(),this.graphics.setVisible(!0)}hideGraphics(){this.graphics.setVisible(!1)}setGraphics(){const e=this.width+2,t=this.height;this.graphics.x=this.x-e/2,this.graphics.y=this.y-t/2}getKey(){return this.texture.key}getGridPosition(){return{x:this.gridX,y:this.gridY}}setGridPosition(e,t){this.gridX=e,this.gridY=t}}class n extends Phaser.Scene{constructor(){super({key:h.GAMEPLAY})}create(){this.firstSelectedTile=null,this.secondSelectedTile=null,this.tileGrid=[];for(let e=0;e<r.gridHeight;e++){this.tileGrid[e]=[];for(let t=0;t<r.gridWidth;t++)this.tileGrid[e].push(this.getRandomTile(e,t))}this.input.on("gameobjectdown",this.onTileClicked,this)}update(){}getRandomTile(e,t){const i=this.cameras.main.width,s=r.candyTypes[Phaser.Math.RND.between(0,r.candyTypes.length-1)];return new l({scene:this,x:r.tileWidth/2+e*(r.tileWidth+r.margin)+(i-(r.tileWidth+r.margin)*r.gridWidth),y:r.tileHeight/2+t*(r.tileHeight+r.margin),texture:s},e,t)}onTileClicked(e,t){this.firstSelectedTile?this.secondSelectedTile||(this.secondSelectedTile=t,this.secondSelectedTile.spin(),this.secondSelectedTile.showGraphics(),this.swapTiles((()=>{if(this.firstSelectedTile&&this.secondSelectedTile){this.firstSelectedTile.unSpin(),this.firstSelectedTile.hideGraphics(),this.secondSelectedTile.unSpin(),this.secondSelectedTile.hideGraphics();const e=this.firstSelectedTile.getGridPosition(),t=this.secondSelectedTile.getGridPosition();this.firstSelectedTile.setGridPosition(t.x,t.y),this.secondSelectedTile.setGridPosition(e.x,e.y)}this.checkMatch(),this.firstSelectedTile=null,this.secondSelectedTile=null}))):(this.firstSelectedTile=t,this.firstSelectedTile.spin(),this.firstSelectedTile.showGraphics())}swapTiles(e){if(this.firstSelectedTile&&this.secondSelectedTile){const t=this.firstSelectedTile.x,i=this.firstSelectedTile.y,s=this.secondSelectedTile.x,r=this.secondSelectedTile.y,h=500,l=this.firstSelectedTile.getGridPosition(),n=this.secondSelectedTile.getGridPosition();this.tileGrid[l.x][l.y]=this.secondSelectedTile,this.tileGrid[n.x][n.y]=this.firstSelectedTile;const c=this.tweens.add({targets:[this.firstSelectedTile],x:s,y:r,duration:h,ease:"Linear",onComplete:()=>{d.isActive()||(e(),c.destroy(),d.destroy())}}),d=this.tweens.add({targets:[this.secondSelectedTile],x:t,y:i,duration:h,ease:"Linear",onComplete:()=>{c.isActive()||(e(),c.destroy(),d.destroy())}})}}resetSelect(){this.firstSelectedTile=null,this.secondSelectedTile=null}checkMatch(){if(this.firstSelectedTile&&this.secondSelectedTile){const e=[],t=[{x:0,y:1},{x:0,y:-1},{x:1,y:0},{x:-1,y:0}],i=[];for(i.push(this.firstSelectedTile),i.push(this.secondSelectedTile);i.length>0;){const s=i.pop(),r=s.getGridPosition();for(let i=0;i<t.length;i++){let h=1;for(;;h++){const e=r.x+t[i].x*h,l=r.y+t[i].y*h;if(!this.isValidGrid(e,l)||this.tileGrid[e][l].getKey()!==s.getKey())break}if(h>2)for(h-=1;h>=0;h--){const s=r.x+t[i].x*h,l=r.y+t[i].y*h;e.push(this.tileGrid[s][l])}}}if(e.length>0)for(let t=0;t<e.length;t++)e[t].setVisible(!1)}}isValidGrid(e,t){return e>=0&&e<r.gridWidth&&t>=0&&t<r.gridHeight}}class c extends Phaser.Scene{constructor(){super({key:h.LOADING})}preload(){this.cameras.main.setBackgroundColor(10016391),this.load.pack("preload","./assets/pack.json","preload")}update(){this.scene.start("GamePlayScene")}}const d={title:"Candy Rush",url:"https://github.com/leanhhuy0709/candy-rush",version:"2.0",type:Phaser.AUTO,parent:"Game",scene:[c,n],input:{keyboard:!0},width:600,height:800,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.Center.CENTER_BOTH},backgroundColor:"#63289e",render:{pixelArt:!1,antialias:!0}};class o extends s.Game{constructor(e){super(e)}}window.addEventListener("load",(()=>{new o(d)}))}},i={};function s(e){var r=i[e];if(void 0!==r)return r.exports;var h=i[e]={exports:{}};return t[e].call(h.exports,h,h.exports,s),h.exports}s.m=t,e=[],s.O=(t,i,r,h)=>{if(!i){var l=1/0;for(o=0;o<e.length;o++){for(var[i,r,h]=e[o],n=!0,c=0;c<i.length;c++)(!1&h||l>=h)&&Object.keys(s.O).every((e=>s.O[e](i[c])))?i.splice(c--,1):(n=!1,h<l&&(l=h));if(n){e.splice(o--,1);var d=r();void 0!==d&&(t=d)}}return t}h=h||0;for(var o=e.length;o>0&&e[o-1][2]>h;o--)e[o]=e[o-1];e[o]=[i,r,h]},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};s.O.j=t=>0===e[t];var t=(t,i)=>{var r,h,[l,n,c]=i,d=0;if(l.some((t=>0!==e[t]))){for(r in n)s.o(n,r)&&(s.m[r]=n[r]);if(c)var o=c(s)}for(t&&t(i);d<l.length;d++)h=l[d],s.o(e,h)&&e[h]&&e[h][0](),e[h]=0;return s.O(o)},i=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var r=s.O(void 0,[216],(()=>s(11)));r=s.O(r)})();