(()=>{"use strict";var e,t={630:(e,t,i)=>{var s=i(260);const r={score:0,highscore:0,gridWidth:8,gridHeight:8,tileWidth:64,tileHeight:72,margin:10,candyTypes:["cookie1","croissant","donut","poptart1","starcookie1"]};var l;!function(e){e.LOADING="LoadingScene",e.GAMEPLAY="GamePlayScene",e.MENU="MenuScene"}(l||(l={}));class h{static init(e){this.scene=e}static getParticleEmitter(e,t,i,s){return this.scene.add.particles(e,t,i,s)}static removeParticleEmitter(e){e.destroy()}}h.particleEmitterList=[];const n=30,o=175;class a{constructor(e){this.level=1,this.levels=[],this.scene=e,this.score=0,this.scoreText=e.add.text(e.cameras.main.width/2,50,"0",{fontFamily:"Cambria",fontSize:55,color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:2}).setDepth(6).setOrigin(.5,.5);for(let e=1;e<1e3;e++)this.levels.push(e*(e+1)/2*500);this.progressBarEmitter=h.getParticleEmitter(n,60,"flares",{frame:"white",color:[9887962,9666291],colorEase:"quad.out",lifespan:500,angle:{min:-190,max:-170},scale:{start:.2,end:0,ease:"sine.out"},speed:100,advance:2e3,blendMode:"ADD"}).setDepth(6),this.scene.add.graphics().lineStyle(3,15546518).setDepth(9).strokeRoundedRect(n,50,o,20,5).fillStyle(11622).fillRoundedRect(n,50,o,20,5).setDepth(4),this.progressBar=this.scene.add.graphics().fillStyle(16110006).fillRoundedRect(n,50,o,20,5).setDepth(5),this.updateProgressBar(0),this.targetText=e.add.text(117.5,30,`${this.levels[this.level]}`,{fontFamily:"Cambria",fontSize:20,color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:2}).setDepth(6).setOrigin(.5,.5)}addScore(e){this.score+=e,this.scoreText.setText(this.score.toString()),this.updateProgressBar((this.score-this.levels[this.level-1])/(this.levels[this.level]-this.levels[this.level-1]))}updateProgressBar(e){e<=.05&&(e=.05),e>1&&(e=1),this.progressBar.clear(),this.progressBar.fillStyle(16110006).fillRoundedRect(n,50,e*o,20,5).setDepth(5),this.progressBarEmitter.setPosition(n+e*o-5,60),e>=.1?this.progressBarEmitter.setVisible(!0):this.progressBarEmitter.setVisible(!1)}handleGoToNextLevel(){for(;this.score>=this.levels[this.level];)this.level++,this.targetText.setText(`${this.levels[this.level]}`),this.updateProgressBar((this.score-this.levels[this.level-1])/(this.levels[this.level]-this.levels[this.level-1])),this.scene.shuffle()}emitterScoreEffect(e,t){const i=this.scene.add.image(e,t,"").setVisible(!1),s=h.getParticleEmitter(0,0,"flares",{frame:{frames:["red","green","blue","yellow"],cycle:!0},blendMode:Phaser.BlendModes.ADD,follow:i,speed:100,gravityY:300,lifespan:1e3,quantity:1,scale:{start:.3,end:.1}}).setDepth(6);let r=(this.score-this.levels[this.level-1])/(this.levels[this.level]-this.levels[this.level-1]);r<=.05&&(r=.05),r>1&&(r=1);const l=this.scene.tweens.add({targets:i,x:n+r*o,y:70,duration:1e3,onComplete:()=>{i.destroy(),h.removeParticleEmitter(s),l.destroy()}})}}class d extends Phaser.GameObjects.Image{constructor(e,t,i){super(e.scene,e.x,e.y,e.texture,e.frame),this.isSuper=!1,this.isMega=!1,this.setOrigin(.5,.5).setInteractive().setDepth(5),this.gridX=t,this.gridY=i,this.graphics=this.scene.add.graphics().lineStyle(2,12183295).setVisible(!1).setDepth(4),this.graphics.strokeRoundedRect(0,0,this.width+2,this.height),this.setGraphics(),this.scene.add.existing(this),this.tween=this.scene.tweens.add({targets:this,angle:360,duration:1500,ease:"Linear",repeat:-1}),this.tween.pause(),this.hintTween=this.scene.tweens.add({targets:this,scale:.8,duration:500,ease:"Linear",repeat:-1,yoyo:!0}),this.hintTween.pause()}spin(){this.tween.resume()}unSpin(){this.tween.pause();const e=this.scene.tweens.add({targets:this,angle:0,duration:800,ease:"Linear",onComplete:()=>e.destroy()})}showGraphics(){this.setGraphics(),this.graphics.setVisible(!0)}hideGraphics(){this.graphics.setVisible(!1)}setGraphics(){const e=this.width+2,t=this.height;this.graphics.x=this.x-e/2,this.graphics.y=this.y-t/2}getKey(){return this.texture.key}selectEffect(){this.spin(),this.showGraphics()}unSelectEffect(){this.unSpin(),this.hideGraphics()}updatePositon(e=!0,t,i,s,l){const h=this.scene.cameras.main.width;let n=500;s&&(n=s),i||(i=0);const o=r.tileWidth/2+this.gridX*(r.tileWidth+r.margin)+(h-(r.tileWidth+r.margin)*r.gridWidth),a=r.tileHeight/2+this.gridY*(r.tileHeight+r.margin)+100;if(e){d.numTweenRunning++;const e=this.scene.tweens.add({targets:this,x:o,y:a,delay:i,duration:n,ease:Phaser.Math.Easing.Bounce.Out,onComplete:()=>{l&&l(),d.numTweenRunning--,t&&0==d.numTweenRunning&&t(),e.destroy()}});if(this.isSuper){const e=this.scene.tweens.add({targets:this.superEmitter,x:o,y:a,delay:i,duration:n,ease:"Power2",onComplete:()=>e.destroy()})}}else this.x=o,this.y=a}goToPosition(e,t,i,s,r,l){d.numTweenRunning++;const h=this.scene.tweens.add({targets:this,x:e,y:t,delay:s,duration:500,ease:"Power2",onComplete:()=>{d.numTweenRunning--,i&&i(),l&&0==d.numTweenRunning&&l(),h.destroy()}});if(this.isSuper){const i=this.scene.tweens.add({targets:this.superEmitter,x:e,y:t,delay:s,duration:500,ease:"Power2",onComplete:()=>i.destroy()})}}setRandomTextures(e,t){const i=r.candyTypes[Phaser.Math.RND.between(0,r.candyTypes.length-1)];if(Math.random()<.3){let i=this.gridX,s=this.gridY;e&&(i=e),t&&(s=t),s<0&&(s=1);const r=this.scene,l=[];r.getTile(i-1,s)&&l.push(r.getTile(i-1,s)),r.getTile(i+1,s)&&l.push(r.getTile(i+1,s)),r.getTile(i,s-1)&&l.push(r.getTile(i,s-1)),r.getTile(i,s+1)&&l.push(r.getTile(i,s+1)),l.length>0&&this.setTexture(l[Phaser.Math.Between(0,l.length-1)].getKey())}else this.setTexture(i)}showHint(){this.hintTween.resume(),this.showGraphics()}hideHint(){this.hintTween.pause(),this.scene.tweens.add({targets:this,scale:1,duration:1e3,ease:"Linear"}),this.hideGraphics()}boom(){if(!(d.boomFlag>10))if(d.boomFlag++,this.isSuperTile()){const e=h.getParticleEmitter(this.x,this.y,"flares",{frame:["red"],lifespan:400,speed:{min:150,max:250},scale:{start:.3,end:0},gravityY:150,blendMode:"ADD",emitting:!1}).setDepth(6);e.explode(16),setTimeout((()=>{h.removeParticleEmitter(e)}),500)}else{const e=h.getParticleEmitter(this.x,this.y,"flares",{frame:[],lifespan:400,speed:{min:150,max:250},scale:{start:.3,end:0},gravityY:150,blendMode:"ADD",emitting:!1}).setDepth(6);e.explode(16),setTimeout((()=>{h.removeParticleEmitter(e)}),500)}}setSuper(e=!0){this.isSuper=e,e?this.superEmitter=h.getParticleEmitter(this.x,this.y+20,"flares",{frame:"red",color:[15994209,16436258,16291840,16266752,10421252,4934223,3486776,263172],lifespan:500,angle:{min:-100,max:-80},scale:{start:.75,end:0,ease:"sine.out"},speed:{min:200,max:300},advance:2e3,blendMode:"ADD"}).setDepth(6):this.superEmitter&&(h.removeParticleEmitter(this.superEmitter),this.superEmitter=null)}setMega(e=!0){this.isMega=e}isSuperTile(){return this.isSuper}isMegaTile(){return this.isMega}updateSuperEmitterPosition(){this.superEmitter&&(this.superEmitter.x=this.x,this.superEmitter.y=this.y+20)}}var c;d.numTweenRunning=0,d.boomFlag=0,function(e){e[e.IDLE=0]="IDLE",e[e.HANDLING=1]="HANDLING"}(c||(c={}));const g=["#ffffff","#bcffe3","#20b2aa","#ff1919"];class T extends Phaser.Scene{constructor(){super({key:l.GAMEPLAY})}create(){this.add.image(0,0,"bg").setOrigin(0,0),h.init(this),this.tileMap=new Map;for(let e=0;e<r.gridHeight;e++)for(let t=0;t<r.gridWidth;t++)this.setTile(e,t,new d({scene:this,x:this.cameras.main.width/2,y:this.cameras.main.height/2,texture:r.candyTypes[Phaser.Math.RND.between(0,r.candyTypes.length-1)]},e,t));this.scoreBoard=new a(this),this.boardState=c.HANDLING,this.shuffle(),this.input.on("gameobjectdown",this.onTileClicked,this)}update(e,t){0==this.idleTime&&(this.isIdleTweenPlaying=!1),this.idleTime+=t,this.handleIdleTime(),this.boardState==c.IDLE&&this.scoreBoard.handleGoToNextLevel()}onTileClicked(e,t){this.idleTime=0,this.firstSelectedTile?this.secondSelectedTile||(this.secondSelectedTile=t,this.secondSelectedTile.selectEffect(),this.isValidSelect()?this.swapTiles((()=>{this.firstSelectedTile&&this.secondSelectedTile&&(this.firstSelectedTile.unSelectEffect(),this.secondSelectedTile.unSelectEffect(),this.handleMatch(((e=!0)=>{e?this.resetSelect():this.swapTiles((()=>{this.resetSelect()}))})))})):(this.firstSelectedTile.unSelectEffect(),this.secondSelectedTile.unSelectEffect(),this.resetSelect())):(this.firstSelectedTile=t,this.firstSelectedTile.selectEffect())}resetSelect(){this.firstSelectedTile=null,this.secondSelectedTile=null}isValidSelect(){if(this.firstSelectedTile&&this.secondSelectedTile){const e=this.firstSelectedTile.gridX,t=this.firstSelectedTile.gridY,i=this.secondSelectedTile.gridX,s=this.secondSelectedTile.gridY;return Math.abs(e-i)+Math.abs(t-s)===1}return!1}swapTiles(e){if(this.firstSelectedTile&&this.secondSelectedTile){const t=this.firstSelectedTile.x,i=this.firstSelectedTile.y,s=this.secondSelectedTile.x,r=this.secondSelectedTile.y,l=500;this.firstSelectedTile.goToPosition(s,r,void 0,void 0,l,(()=>{this.firstSelectedTile&&this.secondSelectedTile&&this.swapTilesWithoutEffect(this.firstSelectedTile.gridX,this.firstSelectedTile.gridY,this.secondSelectedTile.gridX,this.secondSelectedTile.gridY),e()})),this.secondSelectedTile.goToPosition(t,i,void 0,void 0,l,(()=>{this.firstSelectedTile&&this.secondSelectedTile&&this.swapTilesWithoutEffect(this.firstSelectedTile.gridX,this.firstSelectedTile.gridY,this.secondSelectedTile.gridX,this.secondSelectedTile.gridY),e()}))}}swapTilesWithoutEffect(e,t,i,s){const r=this.getTile(e,t),l=this.getTile(i,s);r&&l?(this.setTile(e,t,l),this.setTile(i,s,r),r.gridX=i,r.gridY=s,l.gridX=e,l.gridY=t):console.log("Error swap!")}getTile(e,t){return this.tileMap.get(e.toString()+t.toString())}setTile(e,t,i){this.tileMap.set(e.toString()+t.toString(),i)}removeTile(e,t){this.tileMap.delete(e.toString()+t.toString())}handleMatch(e,t=0){this.idleTime=0,this.boardState=c.HANDLING;const i=[{x:0,y:1},{x:0,y:-1},{x:1,y:0},{x:-1,y:0}];d.boomFlag=0;const s=[];for(let e=0;e<r.gridWidth;e++)s.push(0);const l=[],n=new Map;let o=1;const a=[0],T=[];for(let e=0;e<r.gridHeight;e++)for(let t=0;t<r.gridWidth;t++){const r=this.getTile(e,t);r||console.log("Error index tile!",this.tileMap);const h=n.get(this.convertToKey(e,t));let d=0,c=!1;for(;d<i.length;d++){const g=this.getTile(e+i[d].x,t+i[d].y);if(g&&g.getKey()===r.getKey()){const g=n.get(this.convertToKey(e+i[d].x,t+i[d].y)),f=this.getTile(e-i[d].x,t-i[d].y),p=this.getTile(e+2*i[d].x,t+2*i[d].y);let u;if(h&&(u=h),g&&(u=g),f&&f.getKey()===r.getKey()){c||(s[r.gridX]++,r.boom(),l.push({x:e,y:t,newY:-s[r.gridX]}));const T=n.get(this.convertToKey(e-i[d].x,t-i[d].y));T&&(u=T),null==u&&(u=o,a.push(0),o++),h!=u&&(n.set(this.convertToKey(e,t),u),a[u]++),g!=u&&(n.set(this.convertToKey(e+i[d].x,t+i[d].y),u),a[u]++),T!=u&&(n.set(this.convertToKey(e-i[d].x,t-i[d].y),u),a[u]++),c=!0}if(!c&&p&&p.getKey()===r.getKey()){c||(s[r.gridX]++,r.boom(),l.push({x:e,y:t,newY:-s[r.gridX]}));const T=n.get(this.convertToKey(e+2*i[d].x,t+2*i[d].y));T&&(u=T),null==u&&(u=o,a.push(0),o++),h!=u&&(n.set(this.convertToKey(e,t),u),a[u]++),g!=u&&(n.set(this.convertToKey(e+i[d].x,t+i[d].y),u),a[u]++),T!=u&&(n.set(this.convertToKey(e+2*i[d].x,t+2*i[d].y),u),a[u]++),c=!0}if(c)if(r.isSuperTile()){for(let i=-1;i<=1;i++)for(let s=-1;s<=1;s++)!n.has(this.convertToKey(e+i,t+s))&&this.getTile(e+i,t+s)&&(n.set(this.convertToKey(e+i,t+s),0),T.push({x:e+i,y:t+s}));r.setSuper(!1)}else r.isMegaTile()}}}for(;T.length>0;){const e=T.pop();if(0!=n.get(this.convertToKey(e.x,e.y)))continue;e.x<0&&console.log(e.x);const t=this.getTile(e.x,e.y);if(t){s[e.x]++,t.boom(),this.scoreBoard.addScore(15);const i=this.add.text(t.x,t.y+10,"15",{fontFamily:"Cambria",fontSize:25,color:g[0]}).setDepth(6).setOrigin(.5,.5).setAlpha(0).setStroke("#000000",2),r=this.tweens.add({targets:i,alpha:1,duration:700,y:t.y,onComplete:()=>{i.destroy(),r.destroy()}});if(l.push({x:e.x,y:e.y,newY:-s[e.x]}),t.isSuperTile()){for(let t=-1;t<=1;t++)for(let i=-1;i<=1;i++)!n.has(this.convertToKey(e.x+t,e.y+i))&&this.getTile(e.x+t,e.y+i)&&(n.set(this.convertToKey(e.x+t,e.y+i),0),T.push({x:e.x+t,y:e.y+i}));t.setSuper(!1)}}}const f=[];for(let e=0;e<a.length;e++)f.push({x:0,y:0,gridX:0,gridY:0});const p=[];for(let e=0;e<a.length;e++)p.push([]);for(let e=0;e<l.length;e++){const t=l[e],i=this.getTile(t.x,t.y);if(i){const e=n.get(this.convertToKey(t.x,t.y));e&&(f[e].x+=i.x,f[e].y+=i.y+10,f[e].gridX=i.gridX,f[e].gridY=i.gridY,p[e].push({x:i.gridX,y:i.gridY,tile:i})),this.removeTile(t.x,t.y),i.gridY=t.newY,this.setTile(t.x,t.newY,i),i.updatePositon(!1),i.angle=0}}if(d.boomFlag>10){const e=h.getParticleEmitter(this.cameras.main.width/2,this.cameras.main.height/2,"flares",{frame:["red","blue","green"],lifespan:4e3,speed:{min:300,max:500},scale:1,gravityY:150,blendMode:"ADD",emitting:!1}).setDepth(6);e.explode(50),setTimeout((()=>{h.removeParticleEmitter(e)}),2e3),d.boomFlag=0}const u=[];for(let e=1;e<a.length;e++){let i=0;switch(a[e]){case 0:case 1:case 2:console.log("Error Group");break;case 3:i=30;break;case 4:i=60;break;case 5:i=100;break;case 6:i=200;break;case 7:i=400;break;case 8:i=700;break;default:i=1e3}let r=t+e;r>=g.length&&(r=g.length-1),i*=r;let l=-1,h=-1;const n=new Map,o=new Map;for(let t=0;t<p[e].length;t++){const i=p[e][t];n.has(i.x)||n.set(i.x,0),o.has(i.y)||o.set(i.y,0),n.set(i.x,n.get(i.x)+1),o.set(i.y,o.get(i.y)+1)}let d=-1,c=-1;for(const[e,t]of n)d<t&&(d=t,l=e);for(const[e,t]of o)c<t&&(c=t,h=e);let T=0;for(;T<p[e].length;T++){const t=p[e][T];if(t.x==l&&t.y==h)break}if(T==p[e].length){let t=0;for(;t<p[e].length;t++){const i=p[e][t];if(i.x==l){h=i.y;break}}}if(a[e]>=4){const t=this.getTile(l,-s[l]);t?(t.setTexture(p[e][0].tile.getKey()),s[t.gridX]--,this.removeTile(t.gridX,t.gridY),t.gridX=l,t.gridY=h,this.setTile(t.gridX,t.gridY,t),t.updatePositon(!1),u.push({groupIdx:e,tile:t}),t.setSuper()):console.log("Error Tile!",s)}this.scoreBoard.emitterScoreEffect(f[e].x/a[e],f[e].y/a[e]),this.scoreBoard.addScore(i);const m=this.add.text(f[e].x/a[e],f[e].y/a[e],i.toString(),{fontFamily:"Cambria",fontSize:25,color:g[r]}).setDepth(6).setOrigin(.5,.5).setAlpha(0).setStroke("#000000",2),y=this.tweens.add({targets:m,alpha:1,duration:700,y:f[e].y/a[e]-10,onComplete:()=>{m.destroy(),y.destroy()}})}for(const[e,t]of this.tileMap)t.gridY<0&&t.setVisible(!1);let m=0;for(let e=0;e<u.length;e++)m+=p[u[e].groupIdx].length;if(0==m)this.handleFall(l,T,a,s,t,e);else for(let i=0;i<u.length;i++){const r=u[i].tile,h=u[i].groupIdx;for(let i=0;i<p[h].length;i++){const n=p[h][i],o=new d({scene:this,x:this.cameras.main.width/2,y:this.cameras.main.height/2,texture:r.getKey()},n.x,n.y);o.updatePositon(!1),o.gridX=r.gridX,o.gridY=r.gridY,o.updatePositon(!0,void 0,void 0,500,(()=>{o.destroy(),r.isSuperTile()||r.setSuper(),m--,0==m&&this.handleFall(l,T,a,s,t,e)}))}}}handleFall(e,t,i,s,l,h){if(e.length)for(let e=0;e<r.gridWidth;e++){let t=0;for(let n=r.gridHeight-1;n>=-s[e];n--){const o=this.getTile(e,n);o?t>0&&(n<0&&(o.setRandomTextures(void 0,r.gridWidth-s[e]+n),o.setVisible(!0)),this.removeTile(e,n),o.gridY=n+t,this.setTile(e,n+t,o),o.updatePositon(!0,(()=>{this.handleMatch((()=>{h&&h(),this.boardState=c.IDLE}),l+i.length-1)}),void 0,187.5*s[e])):t++}}else h&&h(!1),this.boardState=c.IDLE}idleEffect(){for(let e=0;e<r.gridHeight;e++)for(let t=0;t<r.gridWidth;t++){const i=this.getTile(e,t);if(!this.isIdleTweenPlaying){const s=this.tweens.add({targets:i,angle:360,delay:(e*r.gridHeight+t)/64*1e3,duration:1e3,ease:"Linear",onComplete:()=>{s.destroy()}})}}this.isIdleTweenPlaying=!0}handleIdleTime(){this.idleTime>1e4?(this.firstSelectedTile&&(this.firstSelectedTile.unSelectEffect(),this.firstSelectedTile=null),this.idleEffect(),this.showHint()):this.hideHint()}handleHint(){const e=[];for(let t=0;t<r.gridHeight;t++)for(let i=0;i<r.gridWidth;i++){const s=this.getTile(t,i),r=this.getTile(t,i+1),l=this.getTile(t,i+2);if(r){if(s.getKey()===r.getKey()){const r=[{T1:this.getTile(t-1,i-1),T2:this.getTile(t,i-1)},{T1:this.getTile(t+1,i-1),T2:this.getTile(t,i-1)},{T1:this.getTile(t-1,i+2),T2:this.getTile(t,i+2)},{T1:this.getTile(t+1,i+2),T2:this.getTile(t,i+2)},{T1:this.getTile(t,i-2),T2:this.getTile(t,i-1)},{T1:this.getTile(t,i+3),T2:this.getTile(t,i+2)}];for(let t=0;t<r.length;t++){const i=r[t].T1,l=r[t].T2;if(i&&l&&s.getKey()===i.getKey())return e.push(i),e.push(l),e}}if(l&&s.getKey()===l.getKey()){const r=[{T1:this.getTile(t-1,i+1),T2:this.getTile(t,i+1)},{T1:this.getTile(t+1,i+1),T2:this.getTile(t,i+1)}];for(let t=0;t<r.length;t++){const i=r[t].T1,l=r[t].T2;if(i&&l&&s.getKey()===i.getKey())return e.push(i),e.push(l),e}}}}for(let t=0;t<r.gridHeight;t++)for(let i=0;i<r.gridWidth;i++){const s=this.getTile(t,i),r=this.getTile(t+1,i),l=this.getTile(t+2,i);if(r){if(s.getKey()===r.getKey()){const r=[{T1:this.getTile(t-1,i-1),T2:this.getTile(t-1,i)},{T1:this.getTile(t-1,i+1),T2:this.getTile(t-1,i)},{T1:this.getTile(t+2,i-1),T2:this.getTile(t+2,i)},{T1:this.getTile(t+2,i+1),T2:this.getTile(t+2,i)},{T1:this.getTile(t-2,i),T2:this.getTile(t-1,i)},{T1:this.getTile(t+3,i),T2:this.getTile(t+2,i)}];for(let t=0;t<r.length;t++){const i=r[t].T1,l=r[t].T2;if(i&&l&&s.getKey()===i.getKey())return e.push(i),e.push(l),e}}if(l&&s.getKey()===l.getKey()){const r=[{T1:this.getTile(t+1,i-1),T2:this.getTile(t+1,i)},{T1:this.getTile(t+1,i+1),T2:this.getTile(t+1,i)}];for(let t=0;t<r.length;t++){const i=r[t].T1,l=r[t].T2;if(i&&l&&s.getKey()===i.getKey())return e.push(i),e.push(l),e}}}}return e}showHint(){const e=this.handleHint();if(0==e.length)return this.firstSelectedTile=this.getTile(0,0),this.secondSelectedTile=this.getTile(0,1),void this.shuffle();this.hintTile1=e[0],this.hintTile2=e[1],this.hintTile1&&this.hintTile2&&(this.hintTile1.showHint(),this.hintTile2.showHint())}hideHint(){this.hintTile1&&this.hintTile2&&(this.hintTile1.hideHint(),this.hintTile2.hideHint(),this.firstSelectedTile&&this.firstSelectedTile.showGraphics(),this.hintTile1=this.hintTile2=null)}convertToKey(e,t){return e.toString()+t.toString()}shuffle(){this.firstSelectedTile=this.getTile(0,0),this.secondSelectedTile=this.getTile(0,1),this.idleTime=0;const e=this.getRandomShape();for(let t=0;t<r.gridHeight;t++)for(let i=0;i<r.gridWidth;i++){const s=this.getTile(t,i);s.setRandomTextures();const l={value:(t*r.gridHeight+i)/(r.gridHeight*r.gridWidth)},h=this.getPointFromShape(e,l.value);s.goToPosition(h.x,h.y,(()=>{const h=this.tweens.add({targets:l,value:(t*r.gridHeight+i)/(r.gridHeight*r.gridWidth)+1,duration:1e3,ease:"Linear",onComplete:()=>{var e;null===(e=this.getTile(t,i))||void 0===e||e.updatePositon(!0,(()=>{this.handleMatch((()=>{this.idleTime=0,this.firstSelectedTile=null,this.secondSelectedTile=null,this.boardState=c.IDLE}))}),Phaser.Math.Between(0,500)),h.destroy()},onUpdate:()=>{let t=l.value;t>1&&(t-=1);const i=this.getPointFromShape(e,t);s.x=i.x,s.y=i.y,s.updateSuperEmitterPosition()}})}))}}getRandomShape(){const e=Phaser.Math.Between(0,2),t=this.cameras.main.width/2,i=this.cameras.main.height/2;switch(e){case 0:return new Phaser.Geom.Rectangle(t-150,i-150,300,300);case 1:return new Phaser.Geom.Circle(t,i,200);default:return new Phaser.Geom.Ellipse(t,i,200,300)}}getPointFromShape(e,t){return e instanceof Phaser.Geom.Rectangle?Phaser.Geom.Rectangle.GetPoint(e,t):e instanceof Phaser.Geom.Circle?Phaser.Geom.Circle.GetPoint(e,t):Phaser.Geom.Ellipse.GetPoint(e,t)}getKeyFromString(e){switch(e.length){case 2:return{x:parseInt(e[0]),y:parseInt(e[1])};case 3:return"-"==e[0]?{x:parseInt(e.substring(0,2)),y:parseInt(e.substring(2,1))}:{x:parseInt(e.substring(0,1)),y:parseInt(e.substring(1,2))};case 4:return{x:parseInt(e.substring(0,2)),y:parseInt(e.substring(2,2))}}}}class f extends Phaser.Scene{constructor(){super({key:l.LOADING})}preload(){this.cameras.main.setBackgroundColor(10016391),this.load.pack("preload","./assets/pack.json","preload")}update(){this.scene.start(l.MENU)}}class p extends Phaser.Scene{constructor(){super({key:l.MENU})}create(){this.add.image(0,0,"bg").setOrigin(0,0),this.add.text(this.cameras.main.width/2,200,"CANDY CRUSH",{fontFamily:"Cambria",fontSize:60,color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:2}).setDepth(4).setOrigin(.5,.5).setAlign("center");const e=this.add.rectangle(this.cameras.main.width/2,325,150,50,11622).setStrokeStyle(3,15546518).setInteractive().setName("PlayBtn");e.on("pointerover",(()=>{e.fillColor=2142890})),e.on("pointerout",(()=>{e.fillColor=11622})),this.add.text(this.cameras.main.width/2,325,"PLAY",{fontFamily:"Cambria",fontSize:30,color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:2}).setDepth(4).setOrigin(.5,.5);const t=this.add.rectangle(this.cameras.main.width/2,400,150,50,11622).setStrokeStyle(3,15546518).setInteractive().setName("SettingBtn");t.on("pointerover",(()=>{t.fillColor=2142890})),t.on("pointerout",(()=>{t.fillColor=11622})),this.add.text(this.cameras.main.width/2,400,"SETTING",{fontFamily:"Cambria",fontSize:30,color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:2}).setDepth(4).setOrigin(.5,.5);const i=this.add.rectangle(this.cameras.main.width/2,475,150,50,11622).setStrokeStyle(3,15546518).setInteractive().setName("SettingBtn");i.on("pointerover",(()=>{i.fillColor=2142890})),i.on("pointerout",(()=>{i.fillColor=11622})),this.add.text(this.cameras.main.width/2,475,"EXIT",{fontFamily:"Cambria",fontSize:30,color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:2}).setDepth(4).setOrigin(.5,.5),this.input.on("gameobjectdown",((e,t)=>{("PlayBtn"==t.name||"SettingBtn"==t.name)&&this.scene.start(l.GAMEPLAY)}),this)}}const u={title:"Candy Rush",url:"https://github.com/leanhhuy0709/candy-rush",version:"2.0",type:Phaser.AUTO,parent:"Game",scene:[f,p,T],input:{keyboard:!0},width:600,height:800,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.Center.CENTER_BOTH},backgroundColor:"#000000",render:{pixelArt:!1,antialias:!0},fps:{forceSetTimeOut:!0,panicMax:0,smoothStep:!1,target:100}};class m extends s.Game{constructor(e){super(e)}}window.addEventListener("load",(()=>{new m(u)}))}},i={};function s(e){var r=i[e];if(void 0!==r)return r.exports;var l=i[e]={exports:{}};return t[e].call(l.exports,l,l.exports,s),l.exports}s.m=t,e=[],s.O=(t,i,r,l)=>{if(!i){var h=1/0;for(d=0;d<e.length;d++){for(var[i,r,l]=e[d],n=!0,o=0;o<i.length;o++)(!1&l||h>=l)&&Object.keys(s.O).every((e=>s.O[e](i[o])))?i.splice(o--,1):(n=!1,l<h&&(h=l));if(n){e.splice(d--,1);var a=r();void 0!==a&&(t=a)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[i,r,l]},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};s.O.j=t=>0===e[t];var t=(t,i)=>{var r,l,[h,n,o]=i,a=0;if(h.some((t=>0!==e[t]))){for(r in n)s.o(n,r)&&(s.m[r]=n[r]);if(o)var d=o(s)}for(t&&t(i);a<h.length;a++)l=h[a],s.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return s.O(d)},i=self.webpackChunktype_project_template=self.webpackChunktype_project_template||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var r=s.O(void 0,[216],(()=>s(630)));r=s.O(r)})();